# Поисковик с использованием TF-IDF и BERT

Эта работа представляет собой простую поисковую систему, которая позволяет выполнять поиск по текстам с использованием двух методов индексации: TF-IDF и эмбеддингов BERT. Система поддерживает предварительное вычисление индексов и сохранение их в файлы, чтобы избежать повторных расчетов.

## Описание

### 1. Корпус данных

В проекте используется корпус текстов из русской Википедии с сайта HuggingFace. Он состоит из 6 тысяч статей.

### 2. Предобработка текста

Тексты проходят следующие этапы обработки перед индексацией:
- Приведение к нижнему регистру
- Удаление пунктуации
- Лемматизация слов с использованием библиотеки `pymorphy2`
- Удаление стоп-слов с использованием библиотеки `nltk`

### 3. Индексация

Реализованы два способа индексации:
- **TF-IDF** : Преобразует тексты в числовые векторы на основе частоты слов в документах и их редкости в корпусе. Для индексации используется `TfidfVectorizer` из библиотеки `scikit-learn`.
- **BERT** : Модель `ruBERT` от `DeepPavlov` используется для генерации эмбеддингов предложений. Она обучена на русскоязычных текстах и токенизирует текст перед преобразованием в эмбеддинги.

### 4. Поиск

Система поддерживает поиск по запросу с использованием выбранного метода индексации (TF-IDF или BERT). Поиск основан на косинусном сходстве между запросом и векторами документов.

## Установка

1. Убедитесь, что у вас установлен **Python 3.8+**.
2. Установите необходимые библиотеки

## Подготовка данных

Перед запуском поиска необходимо выполнить индексацию текстов.

### 1. Загрузка и предобработка корпуса
### 2. Индексация TF-IDF
### 3. Индексация BERT
## Запуск поиска
### Пример использования:

```markdown
Введите текст запроса: Пример запроса
Введите, какой вариант индекса использовать ('tf-idf' или 'bert'): tf-idf
```

Программа вернет список из 5 наиболее релевантных документов с указанием степени их сходства с запросом.

## Структура файлов

```
.
├── README.md                 # Этот файл
├── HW1_Захарова Яна.ipynb    # Основной скрипт с логикой поиска
├── tfidf_vectorizer.pkl      # Предобученный TF-IDF векторизатор
├── tfidf_matrix.pkl          # Матрица TF-IDF
├── bert_embeddings.pkl       # Эмбеддинги BERT
```